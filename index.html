<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <!-- SEO Ø´Ø§Ù…Ù„ ÙˆÙ…ÙŠØªØ§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, shrink-to-fit=no" />
  <meta name="description" content="Ø¹Ø±Ø´ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„: Ù„Ø¹Ø¨Ø© Ù†Ù‚Ø± ØªÙ†Ø§ÙØ³ÙŠØ© 2-4 Ù„Ø§Ø¹Ø¨ÙŠÙ†. Ø§Ù„Ù…Ù„Ùƒ ÙˆØ§Ù„Ø®Ø§Ø³Ø± Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø² ÙˆØ§Ø­Ø¯. Ø§Ø¶ØºØ· ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¨Ø§Ù„Ù…Ø±Ø¨Ø¹ ÙˆØ³Ø¬Ù„ Ø£Ø³Ø±Ø¹ Ù†Ù‚Ø§Ø·." />
  <meta name="keywords" content="Ù„Ø¹Ø¨Ø© Ù†Ù‚Ø±, Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†, Ø¹Ø±Ø´, Ù…Ù„Ùƒ, Ø®Ø§Ø³Ø±, Ù…Ù†Ø§ÙØ³Ø©, Ø¹Ø±Ø¨ÙŠØ©, Ø¨Ø¯ÙˆÙ† Ù†Øª, Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†" />
  <meta name="author" content="ØµØ§Ù†Ø¹ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„" />
  <meta name="robots" content="index, follow" />
  <meta property="og:title" content="Ø¹Ø±Ø´ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„ ğŸ‘‘ - Ø§Ù„Ù…Ù„Ùƒ ÙˆØ§Ù„Ø®Ø§Ø³Ø±" />
  <meta property="og:description" content="Ø£Ø³Ø±Ø¹ Ù„Ø¹Ø¨Ø© Ù†Ù‚Ø± ØªÙ†Ø§ÙØ³ÙŠØ©. Ø§Ø¶ØºØ· ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¨Ø§Ù„Ù…Ø±Ø¨Ø¹.. ÙƒÙ† Ø§Ù„Ù…Ù„Ùƒ!" />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="ar_AR" />
  <link rel="canonical" href="https://alabtal-game.com" />
  <meta name="theme-color" content="#0a0709" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  
  <title>Ø¹Ø±Ø´ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„ ğŸ‘‘ - Ø§Ø¶ØºØ· ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¨Ø§Ù„Ù…Ø±Ø¨Ø¹</title>
  
  <!-- Ø§Ù„Ø®Ø·ÙˆØ· ÙˆØ§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø®ÙÙŠÙØ© ÙˆØ³Ø±ÙŠØ¹Ø© -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  
  <style>
    /* Ù…ØªØºÙŠØ±Ø§Øª ÙˆØ£Ø³Ø§Ø³ÙŠØ§Øª Ù…ØªØ¬Ø¯Ø¯Ø© - Ø³Ù„Ø³Ø© Ø¬Ø¯Ø§Ù‹ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
      font-family: 'Cairo', sans-serif;
    }

    body {
      background: radial-gradient(circle at 50% 30%, #1e1218, #0a0709);
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      min-height: -webkit-fill-available;
      padding: 8px;
      margin: 0;
    }

    /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© - Ù†Ø­ÙŠÙØ© ÙˆØ¬Ø§Ù‡Ø²Ø© */
    .game {
      background: rgba(12, 8, 14, 0.92);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border: 2px solid rgba(212, 175, 55, 0.55);
      border-radius: 40px;
      padding: 18px 14px;
      max-width: 680px;
      width: 100%;
      box-shadow: 0 20px 40px #000000, 0 0 0 1px #d4af37 inset;
    }

    /* Ø±Ø£Ø³ Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…Ø¶ØºÙˆØ· */
    h1 {
      font-size: 1.9rem;
      font-weight: 900;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 6px;
      text-shadow: 0 0 12px #ffd700, 0 0 25px #d4af37;
      margin-bottom: 2px;
    }
    h1 i { color: #ffd700; filter: drop-shadow(0 0 8px gold); }

    .sub {
      background: #1e1510e0;
      padding: 8px 16px;
      border-radius: 50px;
      display: inline-block;
      margin: 0 auto 12px;
      border: 1.5px solid #d4af37;
      font-size: 0.85rem;
      font-weight: 700;
      color: #ffe082;
    }

    /* Ù…Ù†ØªÙ‚ÙŠ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø£ØµØºØ± ÙˆØ£ÙƒØ«Ø± Ø³Ù„Ø§Ø³Ø© */
    .player-selector {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin: 4px 0 14px;
      flex-wrap: wrap;
    }
    .player-option {
      background: #2a1f2a;
      border-radius: 40px;
      padding: 3px;
      border: 2px solid transparent;
    }
    .player-option.active {
      border: 2px solid #ffd966;
      background: #3e2a3e;
      box-shadow: 0 0 16px #ffbf00;
    }
    .player-btn {
      background: #3a2e3a;
      border: none;
      color: #f0e6d2;
      font-size: 0.95rem;
      font-weight: bold;
      padding: 8px 18px;
      border-radius: 40px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: 0.05s;
    }
    .player-btn i { font-size: 1.1rem; }
    .player-btn.active {
      background: #d4af37;
      color: #0a0505;
      box-shadow: 0 0 20px #ffbf00;
    }

    /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† - Ù…Ø±Ø¨Ø¹Ø§Øª Ø£ØµØºØ± ÙˆØ£ÙƒØ«Ø± Ø±Ø´Ø§Ù‚Ø© */
    .players-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(135px, 1fr));
      gap: 12px;
      margin: 12px 0 12px;
    }

    /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ - ØªØµØºÙŠØ± ØªØ§Ù… Ù…Ø¹ Ø¨Ù‚Ø§Ø¡ Ø§Ù„ÙˆØ¶ÙˆØ­ */
    .player-card {
      background: linear-gradient(145deg, #15101b, #0c0810);
      border-radius: 24px;
      padding: 12px 8px;
      box-shadow: 0 10px 16px #00000060;
      border: 2.5px solid;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: 0.1s;
      cursor: pointer;  /* Ø¥Ø´Ø§Ø±Ø© Ø£Ù† Ø£ÙŠ Ù…ÙƒØ§Ù† ÙÙŠ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù‚Ø§Ø¨Ù„ Ù„Ù„Ù†Ù‚Ø± */
    }

    /* Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ø­ØªØ© ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ - Ø³Ù„Ø§Ø³Ø© ØªØ§Ù…Ø© */
    .player-card:active {
      transform: scale(0.98);
      opacity: 0.9;
    }

    /* Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„ØªØ§Ø¬ ÙˆØ§Ù„Ø®Ø§Ø³Ø± Ù…ØµØºØ±Ø© Ø¨Ø´ÙƒÙ„ Ù…ØªÙ†Ø§Ø³Ø¨ */
    .crown-icon, .loser-icon {
      position: absolute;
      top: -14px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 1.7rem;
      filter: drop-shadow(0 0 10px gold);
      z-index: 20;
      pointer-events: none;  /* Ø¹Ø´Ø§Ù† Ù…Ø§ ØªØ¹ØªØ±Ø¶Ø´ Ø§Ù„Ù†Ù‚Ø± */
    }
    .loser-icon { color: #6a6a6a; filter: drop-shadow(0 0 5px #3a3a3a); top: -12px; }

    .player-name {
      font-size: 1.2rem;
      font-weight: 900;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
      margin-bottom: 6px;
    }

    .player-score {
      font-size: 1.8rem;
      font-weight: 900;
      background: #00000060;
      border-radius: 50px;
      padding: 4px 16px;
      width: fit-content;
      margin: 2px auto;
      border: 2px solid #ffffff70;
    }

    /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø²Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ… - Ù„Ø£Ù† Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù†ÙØ³Ù‡ */
    .click-btn {
      display: none !important;
    }

    /* ØºØ±ÙØ© Ø§Ù„Ø¹Ø±Ø´ - Ù…ØµØºØ±Ø© ÙˆÙ…ØªØ¬Ø§ÙˆØ¨Ø© */
    .throne-room {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      background: #0f080ec0;
      border-radius: 50px;
      padding: 10px 14px;
      margin: 12px 0 8px;
      border: 1.5px solid #b4945c;
      gap: 8px;
      flex-wrap: wrap;
    }
    .king-area, .loser-area {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.95rem;
    }
    .king-label, .loser-label {
      padding: 5px 14px;
      border-radius: 40px;
      font-weight: 900;
      font-size: 0.95rem;
      box-shadow: 0 0 18px gold;
      white-space: nowrap;
    }
    .loser-label { background: #2a2a3a; box-shadow: 0 0 10px #1e1e1e; }

    @media (max-width: 450px) {
      .throne-room { flex-direction: column; }
      .players-grid { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 330px) {
      .players-grid { grid-template-columns: 1fr; }
    }

    /* Ø§Ù„Ù…Ø¤Ù‚Øª ÙˆØ´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
    .timer-global {
      background: #1a0f1c;
      border-radius: 40px;
      padding: 8px 16px;
      margin: 6px 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border: 1px solid #d4af37;
    }
    .timer-box {
      font-size: 1.5rem;
      font-weight: 900;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    #globalTime {
      background: #00000080;
      padding: 4px 16px;
      border-radius: 40px;
      color: #ffe082;
    }
    .progress {
      width: 100%;
      height: 10px;
      background: #2a1f2f;
      border-radius: 20px;
      margin-top: 8px;
    }
    #progressFill {
      height: 100%;
      width: 100%;
      background: linear-gradient(90deg, #e4b138, #ffd966);
      border-radius: 20px;
      transition: width 0.1s linear;
    }

    /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… ØµØºÙŠØ±Ø© ÙˆØ³Ø±ÙŠØ¹Ø© */
    .control-panel {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin: 14px 0 4px;
      flex-wrap: wrap;
    }
    .ctrl-btn {
      background: #2a1e32;
      border: 2px solid #b4945c;
      color: #ffd966;
      padding: 8px 18px;
      border-radius: 50px;
      font-size: 0.85rem;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      transition: 0.05s;
    }
    .ctrl-btn:active { background: #4f3462; border-color: #ffd966; }

    /* ØªØ°ÙŠÙŠÙ„ ØµØºÙŠØ± */
    footer p { font-size: 0.65rem; opacity: 0.8; margin-top: 12px; }

    /* ØªØ­Ø³ÙŠÙ† ÙˆØµÙˆÙ„ ÙˆØ¥Ù…ÙƒØ§Ù†ÙŠØ© */
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; }
  </style>
</head>
<body>
  <main class="game" role="main" aria-label="Ø¹Ø±Ø´ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„ - Ø§Ø¶ØºØ· Ø¨Ø§Ù„Ù…Ø±Ø¨Ø¹">
    <header>
      <h1><i class="fas fa-crown"></i> Ø¹Ø±Ø´ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„ <i class="fas fa-throne"></i></h1>
      <div class="sub"><i class="fas fa-hand-pointer"></i> Ø§Ø¶ØºØ· ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¨Ø§Ù„Ù…Ø±Ø¨Ø¹ .. Ø£Ø³Ø±Ø¹ Ù†Ù‚Ø§Ø· ØªÙÙˆØ²</div>
    </header>

    <!-- Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† -->
    <div class="player-selector" role="tablist">
      <div class="player-option" id="option2"><button id="select2Players" class="player-btn"><i class="fas fa-user-friends"></i> 2</button></div>
      <div class="player-option" id="option3"><button id="select3Players" class="player-btn"><i class="fas fa-users"></i> 3</button></div>
      <div class="player-option" id="option4"><button id="select4Players" class="player-btn"><i class="fas fa-people-arrows"></i> 4</button></div>
    </div>

    <!-- Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† - Ø§Ù„Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ù†Ù‚Ø± ÙÙŠ Ø£ÙŠ Ù…ÙƒØ§Ù† -->
    <div id="playersContainer" class="players-grid" aria-label="Ø³Ø§Ø­Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†"></div>

    <!-- Ø§Ù„Ù…Ø¤Ù‚Øª Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ -->
    <div class="timer-global">
      <div class="timer-box"><i class="fas fa-hourglass-half"></i><span id="globalTime">10.0</span></div>
      <div style="font-size:1rem;"><i class="fas fa-fist-raised"></i> Ø§Ø¶ØºØ· Ø¨Ø·Ù„Ø§Ù‚Ø©</div>
    </div>
    <div class="progress"><div id="progressFill" style="width:100%;"></div></div>

    <!-- ØºØ±ÙØ© Ø§Ù„Ø¹Ø±Ø´ : Ø§Ù„Ù…Ù„Ùƒ Ùˆ Ø§Ù„Ø®Ø§Ø³Ø± -->
    <div class="throne-room">
      <div class="king-area"><i class="fas fa-crown" style="font-size:1.8rem; color:#ffd700;"></i><span class="king-label" id="kingName">Ù„Ø§ Ù…Ù„Ùƒ</span></div>
      <div class="loser-area"><i class="fas fa-broken" style="font-size:1.5rem; color:#a0a0a0;"></i><span class="loser-label" id="loserName">Ù„Ø§ Ø®Ø§Ø³Ø±</span></div>
    </div>

    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
    <div class="control-panel">
      <button id="resetGameBtn" class="ctrl-btn"><i class="fas fa-rotate-right"></i> Ù…Ø¹Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©</button>
      <button id="hardGlobalBtn" class="ctrl-btn"><i class="fas fa-skull"></i> ØªØ­Ø¯Ù</button>
    </div>
    <footer><p>ğŸ‘‘ Ø§Ø¶ØºØ· Ø¨Ø§Ù„Ù…Ø±Ø¨Ø¹ .. Ø§Ù„Ù…Ù„Ùƒ Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø· .. Ø§Ù„Ø®Ø§Ø³Ø± Ø£Ù‚Ù„ Ù†Ù‚Ø§Ø·</p></footer>
  </main>

  <script>
    (function() {
      "use strict";

      // ------------------------------
      // Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø®Ø§Ø±Ù‚: Ù…Ø±Ø¨Ø¹Ø§Øª ØµØºÙŠØ±Ø© - Ù†Ù‚Ø± ÙÙŠ Ø£ÙŠ Ø­ØªØ© - Ø³Ù„Ø§Ø³Ø© ÙØ§Ø¦Ù‚Ø©
      // ------------------------------

      const PLAYER_COLORS = [
        { name: 'Ø§Ù„Ø£Ø­Ù…Ø±', bg: '#b71c1c', light: '#f05545', btn: '#d32f2f', icon: 'fa-dragon' },
        { name: 'Ø§Ù„Ø£Ø²Ø±Ù‚', bg: '#0d47a1', light: '#5472d3', btn: '#1565c0', icon: 'fa-whale' },
        { name: 'Ø§Ù„Ø£Ø®Ø¶Ø±', bg: '#1b5e20', light: '#6ab04a', btn: '#2e7d32', icon: 'fa-tree' },
        { name: 'Ø§Ù„Ø°Ù‡Ø¨ÙŠ', bg: '#7d4e1a', light: '#ffb74d', btn: '#a5641e', icon: 'fa-lion' }
      ];

      let playersCount = 2;
      let players = [];
      let timeLeft = 10.0;
      let gameActive = false;
      let gameFinished = false;
      let globalTimer = null;
      let hardMode = false;

      // DOM
      const playersContainer = document.getElementById('playersContainer');
      const globalTimeEl = document.getElementById('globalTime');
      const progressFill = document.getElementById('progressFill');
      const kingNameEl = document.getElementById('kingName');
      const loserNameEl = document.getElementById('loserName');
      const resetBtn = document.getElementById('resetGameBtn');
      const hardGlobalBtn = document.getElementById('hardGlobalBtn');
      const select2Btn = document.getElementById('select2Players');
      const select3Btn = document.getElementById('select3Players');
      const select4Btn = document.getElementById('select4Players');
      const option2 = document.getElementById('option2');
      const option3 = document.getElementById('option3');
      const option4 = document.getElementById('option4');

      // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
      function initPlayers(count) {
        players = [];
        for (let i = 0; i < count; i++) {
          let colorIndex = i % PLAYER_COLORS.length;
          players.push({
            id: i,
            name: `Ø§Ù„Ù„Ø§Ø¹Ø¨ ${i+1}`,
            color: PLAYER_COLORS[colorIndex].bg,
            lightColor: PLAYER_COLORS[colorIndex].light,
            btnColor: PLAYER_COLORS[colorIndex].btn,
            icon: PLAYER_COLORS[colorIndex].icon,
            score: 0,
            isKing: false,
            isLoser: false,
          });
        }
        renderPlayers();
        updateKingAndLoser();
      }

      // Ø±Ø³Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª - Ù…Ø¹ Ø®Ø§ØµÙŠØ© Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¨Ø§Ù„Ù…Ø±Ø¨Ø¹ (Ø³Ù„Ø§Ø³Ø© ØªØ§Ù…Ø©)
      function renderPlayers() {
        let html = '';
        players.forEach((p, idx) => {
          html += `
            <div id="playerCard-${idx}" class="player-card" style="border-color: ${p.color}; background: linear-gradient(145deg, #15101b, #0c0810);">
              <div id="crownIcon-${idx}" class="crown-icon" style="display: none;"><i class="fas fa-crown" style="color: gold; filter: drop-shadow(0 0 12px orange);"></i></div>
              <div id="loserIcon-${idx}" class="loser-icon" style="display: none;"><i class="fas fa-poop" style="color: #6b5a4b; filter: drop-shadow(0 0 5px #3a2a1a);"></i></div>
              <div class="player-name" style="color: ${p.lightColor};">
                <i class="fas ${p.icon}"></i> ${p.name}
              </div>
              <div id="playerScore-${idx}" class="player-score" style="color: white; background: ${p.color}dd; border: 2.5px solid ${p.lightColor};">
                ${p.score}
              </div>
              <!-- ØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø²Ø± Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ ÙˆØ§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ø¨Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù†ÙØ³Ù‡Ø§ -->
            </div>
          `;
        });
        playersContainer.innerHTML = html;

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ø§Ù„Ù†Ù‚Ø± Ø§Ù„ÙØ§Ø¦Ù‚: Ø£ÙŠ Ø­ØªØ© ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ ØªØ³Ø¬Ù„ Ù†Ù‚Ø§Ø·
        players.forEach((_, idx) => {
          const card = document.getElementById(`playerCard-${idx}`);
          if (card) {
            // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ù…Ø³ØªÙ…Ø¹ Ù‚Ø¯ÙŠÙ… Ø«Ù… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªÙ…Ø¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯
            card.replaceWith(card.cloneNode(true));
            const newCard = document.getElementById(`playerCard-${idx}`);
            
            // Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø± Ø§Ù„Ø¹Ø§Ø¯ÙŠ + Ø§Ù„Ù„Ù…Ø³ Ù„Ù„Ù‡ÙˆØ§ØªÙ Ø¨Ø³Ù„Ø§Ø³Ø©
            newCard.addEventListener('click', function(e) {
              e.preventDefault();
              e.stopPropagation(); // Ù…Ù†Ø¹ Ø£ÙŠ ØªØ¶Ø§Ø±Ø¨
              handlePlayerClick(idx);
            });

            // Ø¯Ø¹Ù… Ø§Ù„Ù„Ù…Ø³ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù…Ø¹ Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø¹Ø±Ø¶ÙŠ
            newCard.addEventListener('touchstart', function(e) {
              e.preventDefault(); // ÙŠÙ…Ù†Ø¹ ØªÙ…Ø±ÙŠØ± Ø§Ù„ØµÙØ­Ø©
              handlePlayerClick(idx);
            }, { passive: false });
          }
        });
      }

      // Ù…Ù†Ø·Ù‚ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†Ù‚Ø§Ø·
      function handlePlayerClick(playerIndex) {
        // Ù„Ø§ Ù†Ù‚Ø§Ø· Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª
        if (timeLeft <= 0.0) return;
        
        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¤Ù‚Øª Ù…Ø¹ Ø£ÙˆÙ„ Ù†Ù‚Ø±Ø©
        if (!gameActive && !gameFinished) {
          startGlobalTimer();
          gameActive = true;
        }

        // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù†Ù‚Ø§Ø·
        const player = players[playerIndex];
        player.score += 1;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
        const scoreEl = document.getElementById(`playerScore-${playerIndex}`);
        if (scoreEl) scoreEl.textContent = player.score;

        // ÙˆØ¶Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠ: Ø®ØµÙ… 0.05 Ø«Ø§Ù†ÙŠØ© Ù…Ø¹ ÙƒÙ„ Ø¶ØºØ·Ø©
        if (hardMode && timeLeft > 0.05) {
          timeLeft = Math.max(0.0, timeLeft - 0.05);
          globalTimeEl.textContent = timeLeft.toFixed(1);
          updateProgressBar();
        }

        // Ø±Ø¯ ÙØ¹Ù„ Ø¨Ø³ÙŠØ·: Ø§Ù‡ØªØ²Ø§Ø² Ø®ÙÙŠÙ
        if (navigator.vibrate) navigator.vibrate(6);

        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù„Ùƒ ÙˆØ§Ù„Ø®Ø§Ø³Ø±
        updateKingAndLoser();

        // Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª
        if (timeLeft <= 0.0) {
          timeLeft = 0.0;
          globalTimeEl.textContent = '0.0';
          endGame();
        }
      }

      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ùƒ (Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø·) ÙˆØ§Ù„Ø®Ø§Ø³Ø± (Ø£Ù‚Ù„ Ù†Ù‚Ø§Ø·)
      function updateKingAndLoser() {
        if (!players.length) return;
        
        players.forEach(p => { p.isKing = false; p.isLoser = false; });

        let maxScore = -Infinity, minScore = Infinity;
        let kingIdx = 0, loserIdx = 0;

        players.forEach((p, idx) => {
          if (p.score > maxScore) { maxScore = p.score; kingIdx = idx; }
          if (p.score < minScore) { minScore = p.score; loserIdx = idx; }
        });

        if (maxScore === 0 && minScore === 0) {
          kingNameEl.textContent = 'Ù„Ø§ Ù…Ù„Ùƒ';
          loserNameEl.textContent = 'Ù„Ø§ Ø®Ø§Ø³Ø±';
        } else {
          players[kingIdx].isKing = true;
          kingNameEl.textContent = `${players[kingIdx].name} (${players[kingIdx].score})`;
          kingNameEl.style.background = players[kingIdx].color;
          kingNameEl.style.boxShadow = `0 0 30px ${players[kingIdx].lightColor}`;

          players[loserIdx].isLoser = true;
          loserNameEl.textContent = `${players[loserIdx].name} (${players[loserIdx].score})`;
          loserNameEl.style.background = '#2a2a3a';
          loserNameEl.style.boxShadow = `0 0 12px #1e1e1e`;
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙŠØ¬Ø§Ù† ÙˆØ§Ù„Ø£Ù„Ù‚Ø§Ø¨ ÙˆØ§Ù„Ø­Ø¯ÙˆØ¯
        players.forEach((p, idx) => {
          const crownIcon = document.getElementById(`crownIcon-${idx}`);
          const loserIcon = document.getElementById(`loserIcon-${idx}`);
          if (crownIcon) crownIcon.style.display = p.isKing ? 'block' : 'none';
          if (loserIcon) loserIcon.style.display = p.isLoser ? 'block' : 'none';

          const card = document.getElementById(`playerCard-${idx}`);
          if (card) {
            if (p.isKing) {
              card.style.border = `4px solid gold`;
              card.style.boxShadow = `0 0 30px gold`;
            } else if (p.isLoser) {
              card.style.border = `2.5px solid #5a5a5a`;
              card.style.boxShadow = `0 0 12px #3a3a3a`;
            } else {
              card.style.border = `2.5px solid ${p.color}`;
              card.style.boxShadow = `0 8px 16px #00000080`;
            }
          }
        });
      }

      // Ù…Ø¤Ù‚Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
      function startGlobalTimer() {
        if (globalTimer) clearInterval(globalTimer);
        globalTimer = setInterval(() => {
          if (timeLeft > 0.0) {
            timeLeft = Math.max(0.0, timeLeft - 0.1);
            globalTimeEl.textContent = timeLeft.toFixed(1);
            updateProgressBar();
            if (timeLeft <= 0.0) {
              timeLeft = 0.0;
              globalTimeEl.textContent = '0.0';
              endGame();
              clearInterval(globalTimer);
              globalTimer = null;
            }
          } else {
            endGame();
            clearInterval(globalTimer);
            globalTimer = null;
          }
        }, 100);
      }

      function updateProgressBar() {
        let percent = (timeLeft / 10) * 100;
        if (percent < 0) percent = 0;
        progressFill.style.width = `${percent}%`;
      }

      function endGame() {
        gameActive = false;
        gameFinished = true;
        // Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù„Ø£Ù†Ù‡ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø²Ø±Ø§Ø±ØŒ Ø§Ù„Ù†Ù‚Ø± Ù„Ø§ ÙŠØ¹Ù…Ù„ Ø¨Ø³Ø¨Ø¨ timeLeft <= 0
        updateKingAndLoser();
      }

      // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø· Ø§Ù„ÙƒØ§Ù…Ù„
      function fullReset() {
        if (globalTimer) clearInterval(globalTimer);
        globalTimer = null;
        gameActive = false;
        gameFinished = false;
        timeLeft = 10.0;
        globalTimeEl.textContent = '10.0';
        updateProgressBar();

        players.forEach((p, idx) => {
          p.score = 0;
          p.isKing = false;
          p.isLoser = false;
          const scoreEl = document.getElementById(`playerScore-${idx}`);
          if (scoreEl) scoreEl.textContent = '0';
        });

        kingNameEl.textContent = 'Ù„Ø§ Ù…Ù„Ùƒ';
        loserNameEl.textContent = 'Ù„Ø§ Ø®Ø§Ø³Ø±';
        kingNameEl.style.background = '#ffd700';
        loserNameEl.style.background = '#2a2a3a';

        players.forEach((_, idx) => {
          const crownIcon = document.getElementById(`crownIcon-${idx}`);
          const loserIcon = document.getElementById(`loserIcon-${idx}`);
          if (crownIcon) crownIcon.style.display = 'none';
          if (loserIcon) loserIcon.style.display = 'none';
          const card = document.getElementById(`playerCard-${idx}`);
          if (card && players[idx]) {
            card.style.border = `2.5px solid ${players[idx].color}`;
            card.style.boxShadow = `0 8px 16px #00000080`;
          }
        });
      }

      // ØªØºÙŠÙŠØ± Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
      function setPlayersCount(count) {
        playersCount = count;
        [option2, option3, option4].forEach(el => el?.classList.remove('active'));
        [select2Btn, select3Btn, select4Btn].forEach(el => el?.classList.remove('active'));

        if (count === 2) { option2?.classList.add('active'); select2Btn?.classList.add('active'); }
        else if (count === 3) { option3?.classList.add('active'); select3Btn?.classList.add('active'); }
        else { option4?.classList.add('active'); select4Btn?.classList.add('active'); }

        fullReset();
        initPlayers(count);
      }

      // ØªØ¨Ø¯ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠ
      function toggleHardMode() {
        hardMode = !hardMode;
        if (hardMode) {
          hardGlobalBtn.style.background = '#7a2e2e';
          hardGlobalBtn.style.borderColor = '#ff8a5c';
          hardGlobalBtn.innerHTML = '<i class="fas fa-skull"></i> ØªØ­Ø¯Ù Ù†Ø´Ø·';
        } else {
          hardGlobalBtn.style.background = '#2a1e32';
          hardGlobalBtn.style.borderColor = '#b4945c';
          hardGlobalBtn.innerHTML = '<i class="fas fa-skull"></i> ØªØ­Ø¯Ù';
        }
      }

      // Ø±Ø¨Ø· Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ø²Ø±Ø§Ø±
      select2Btn.addEventListener('click', () => setPlayersCount(2));
      select3Btn.addEventListener('click', () => setPlayersCount(3));
      select4Btn.addEventListener('click', () => setPlayersCount(4));
      resetBtn.addEventListener('click', () => { fullReset(); initPlayers(playersCount); });
      hardGlobalBtn.addEventListener('click', toggleHardMode);

      // Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚
      setPlayersCount(2);
    })();
  </script>
</body>
</html>
