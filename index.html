<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <!-- ØªØ­Ø³ÙŠÙ† Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø´Ø§Ù…Ù„ ÙˆØ§Ù„Ù…ÙŠØªØ§ Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="description" content="Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø£Ø¨Ø·Ø§Ù„: Ù„Ø¹Ø¨Ø© Ø§Ù„Ù†Ù‚Ø± Ø§Ù„ØªÙ†Ø§ÙØ³ÙŠØ© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†. ÙƒÙ† Ø§Ù„Ù…Ù„Ùƒ ÙˆØªØ¬Ù†Ø¨ Ø§Ù„Ø®Ø§Ø³Ø± ÙÙŠ ØµØ±Ø§Ø¹ Ø§Ù„Ø³Ø±Ø¹Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø´. Ø¯Ø¹Ù… 2-4 Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø² ÙˆØ§Ø­Ø¯." />
  <meta name="keywords" content="Ù„Ø¹Ø¨Ø© Ù†Ù‚Ø±, Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†, Ø¹Ø±Ø´, Ù…Ù„Ùƒ, Ø®Ø§Ø³Ø±, ØªØ­Ø¯ÙŠ, Ù…Ù†Ø§ÙØ³Ø©, Ø£Ù„Ø¹Ø§Ø¨ Ø¹Ø±Ø¨ÙŠØ©, Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†, Ø¨Ø¯ÙˆÙ† Ù†Øª" />
  <meta name="author" content="ØµØ§Ù†Ø¹ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„" />
  <meta name="robots" content="index, follow" />
  <meta property="og:title" content="Ø¹Ø±Ø´ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„ ğŸ‘‘ - Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ù„Ùƒ ÙˆØ§Ù„Ø®Ø§Ø³Ø±" />
  <meta property="og:description" content="ØªÙ†Ø§ÙØ³ Ù…Ø¹ Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø² ÙˆØ§Ø­Ø¯: Ù…Ù† ÙŠØµØ¨Ø­ Ø§Ù„Ù…Ù„ÙƒØŸ ÙˆÙ…Ù† Ù‡Ùˆ Ø§Ù„Ø®Ø§Ø³Ø±ØŸ Ø§Ø¶ØºØ· Ø¨Ø³Ø±Ø¹Ø© ÙˆØ§Ø±Ø¨Ø£ Ø§Ù„Ø¹Ø±Ø´." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://i.imgur.com/VDWjZ0c.png" /> <!-- ØµÙˆØ±Ø© Ø±Ù…Ø²ÙŠØ© Ù„Ù„Ø¹Ø¨Ø© -->
  <meta property="og:locale" content="ar_AR" />
  <link rel="canonical" href="https://alabtal-game.com" />
  <meta name="theme-color" content="#0a0709" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  
  <title>Ø¹Ø±Ø´ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„ ğŸ‘‘ Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ù„Ùƒ ÙˆØ§Ù„Ø®Ø§Ø³Ø± - Ø§Ø¶ØºØ· ÙˆØ§Ø±Ø¨Ø­</title>
  
  <!-- Fonts ÙˆØ§ÙŠ ÙÙˆÙ† Ø±Ø§Ø¦Ø¹ Ù„Ù„Ø£Ø¯Ø§Ø¡ -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet" />
  <!-- Font Awesome 6 (Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø®ÙÙŠÙØ©) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  
  <style>
    /* Ù…ØªØºÙŠØ±Ø§Øª Ù„Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„Ù…Ø±ÙˆÙ†Ø© Ø§Ù„Ù‚ØµÙˆÙ‰ */
    :root {
      --bg-dark: #0a0709;
      --gold: #ffd700;
      --gold-light: #ffed4e;
      --king-bg: #b71c1c;
      --loser-bg: #2a2a3a;
      --card-bg: #1a131f;
      --border-shine: rgba(212, 175, 55, 0.6);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
      font-family: 'Cairo', sans-serif;
    }

    body {
      background: radial-gradient(circle at 50% 30%, #1e1218, #0a0709);
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      min-height: -webkit-fill-available;
      padding: 12px;
      margin: 0;
      transition: all 0.2s;
    }

    /* Ø§Ù„ØªÙƒÙŠÙ Ø§Ù„ØªØ§Ù… Ù…Ø¹ Ø§Ù„Ù‡ÙˆØ§ØªÙ */
    .game {
      background: rgba(18, 12, 20, 0.92);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 2px solid var(--border-shine);
      border-radius: 48px;
      padding: 22px 16px;
      max-width: 700px;
      width: 100%;
      box-shadow: 0 25px 50px #000000, 0 0 0 1px #d4af37 inset;
      transition: all 0.25s ease;
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ */
    @media (max-width: 420px) {
      .game { padding: 16px 12px; border-radius: 36px; }
      h1 { font-size: 1.9rem; }
      .sub { font-size: 0.9rem; padding: 8px 16px; }
    }

    h1 {
      font-size: 2.2rem;
      font-weight: 900;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      text-shadow: 0 0 15px #ffd700, 0 0 35px #d4af37;
      letter-spacing: 2px;
      margin-bottom: 8px;
    }

    h1 i {
      color: var(--gold);
      filter: drop-shadow(0 0 12px gold);
    }

    .sub {
      background: #1e1510e0;
      padding: 10px 20px;
      border-radius: 50px;
      display: inline-block;
      margin: 0 auto 16px;
      border: 2px solid #d4af37;
      font-size: 1rem;
      font-weight: 700;
      color: #ffe082;
      width: fit-content;
    }

    /* Ù…Ù†ØªÙ‚ÙŠ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† - Ù…ØªØ¬Ø§ÙˆØ¨ ÙˆÙ…Ø±Ù† */
    .player-selector {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin: 5px 0 20px;
      flex-wrap: wrap;
    }

    .player-option {
      background: #2a1f2a;
      border-radius: 50px;
      padding: 4px;
      border: 2px solid transparent;
      transition: 0.15s;
      flex: 0 1 auto;
    }

    .player-option.active {
      border: 2px solid #ffd966;
      background: #3e2a3e;
      box-shadow: 0 0 20px #ffbf00;
    }

    .player-btn {
      background: #3a2e3a;
      border: none;
      color: #f0e6d2;
      font-size: 1.1rem;
      font-weight: bold;
      padding: 10px 22px;
      border-radius: 50px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: 0.1s;
    }

    .player-btn i { font-size: 1.3rem; }
    .player-btn.active {
      background: #d4af37;
      color: #0a0505;
      box-shadow: 0 0 30px #ffbf00;
    }

    /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† - Ù…ØªØ¬Ø§ÙˆØ¨Ø© Ù…Ø¹ Ø§Ù„Ù€ 4 Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø­ØªÙ‰ Ø£ØµØºØ± Ø´Ø§Ø´Ø© */
    .players-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 16px;
      margin: 20px 0 18px;
    }

    @media (max-width: 480px) {
      .players-grid { grid-template-columns: repeat(2, 1fr); gap: 12px; }
    }
    @media (max-width: 360px) {
      .players-grid { grid-template-columns: 1fr; gap: 14px; }
    }

    .player-card {
      background: linear-gradient(145deg, #1a131f, #0f0a12);
      border-radius: 32px;
      padding: 18px 10px;
      box-shadow: 0 12px 20px #00000080;
      transition: 0.2s;
      border: 3px solid;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .crown-icon, .loser-icon {
      position: absolute;
      top: -16px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 2rem;
      filter: drop-shadow(0 0 12px gold);
      z-index: 15;
    }
    .loser-icon { color: #6a6a6a; filter: drop-shadow(0 0 6px #3a3a3a); top: -14px; }

    .player-name {
      font-size: 1.5rem;
      font-weight: 900;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      margin-bottom: 10px;
    }

    .player-score {
      font-size: 2rem;
      font-weight: 900;
      background: #00000070;
      border-radius: 60px;
      padding: 8px 20px;
      width: fit-content;
      margin: 5px auto;
      border: 2px solid #ffffff70;
    }

    .click-btn {
      width: 100%;
      padding: 14px 0;
      border-radius: 50px;
      border: none;
      font-size: 1.2rem;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-top: 12px;
      cursor: pointer;
      transition: 0.05s;
      border: 2px solid white;
      touch-action: manipulation;
    }
    .click-btn:active { transform: scale(0.92); }
    .click-btn:disabled { opacity: 0.5; filter: grayscale(1); transform: none; }

    /* ØºØ±ÙØ© Ø§Ù„Ø¹Ø±Ø´ Ø¨ØªØµÙ…ÙŠÙ… Ø¹Ù…ÙˆØ¯ÙŠ Ù„Ù„Ù‡ÙˆØ§ØªÙ */
    .throne-room {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      background: #0f080ec0;
      border-radius: 60px;
      padding: 12px 16px;
      margin: 20px 0 12px;
      border: 2px solid #b4945c;
      backdrop-filter: blur(8px);
      gap: 8px;
      flex-wrap: wrap;
    }

    .king-area, .loser-area {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 1.2rem;
    }

    .king-label, .loser-label {
      padding: 8px 18px;
      border-radius: 50px;
      font-weight: 900;
      font-size: 1.2rem;
      box-shadow: 0 0 25px gold;
      white-space: nowrap;
    }
    .loser-label { background: #2a2a3a; color: #dfdfdf; box-shadow: 0 0 15px #1e1e1e; }

    @media (max-width: 550px) {
      .throne-room { flex-direction: column; align-items: stretch; }
      .king-area, .loser-area { justify-content: center; }
    }

    /* Ø§Ù„Ù…Ø¤Ù‚Øª ÙˆØ§Ù„Ø´Ø±ÙŠØ· */
    .timer-global {
      background: #1a0f1c;
      border-radius: 50px;
      padding: 12px 18px;
      margin: 8px 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border: 1px solid #d4af37;
      flex-wrap: wrap;
    }
    .timer-box {
      font-size: 1.8rem;
      font-weight: 900;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    #globalTime {
      background: #00000080;
      padding: 5px 18px;
      border-radius: 40px;
      color: #ffe082;
    }
    .progress {
      width: 100%;
      height: 14px;
      background: #2a1f2f;
      border-radius: 20px;
      margin-top: 12px;
    }
    #progressFill {
      height: 100%;
      width: 100%;
      background: linear-gradient(90deg, #e4b138, #ffd966);
      border-radius: 20px;
      transition: width 0.15s;
      box-shadow: 0 0 16px #ffbf00;
    }

    .control-panel {
      display: flex;
      gap: 14px;
      justify-content: center;
      margin: 20px 0 5px;
      flex-wrap: wrap;
    }
    .ctrl-btn {
      background: #2a1e32;
      border: 2px solid #b4945c;
      color: #ffd966;
      padding: 12px 22px;
      border-radius: 60px;
      font-size: 1rem;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: 0.1s;
      flex: 0 1 auto;
    }
    .ctrl-btn i { font-size: 1.2rem; }
    .ctrl-btn:active { background: #4f3462; border-color: #ffd966; color: white; }

    /* ØªØ­Ø³ÙŠÙ† SEO ÙˆØ¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0,0,0,0);
      border: 0;
    }

    footer {
      font-size: 0.7rem;
      opacity: 0.7;
      margin-top: 16px;
    }
  </style>
</head>
<body>
  <main class="game" role="main" aria-label="Ù„Ø¹Ø¨Ø© Ø¹Ø±Ø´ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„ØªÙ†Ø§ÙØ³ÙŠØ©">
    <header>
      <h1 aria-label="Ø¹Ø±Ø´ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„">
        <i class="fas fa-crown" aria-hidden="true"></i> Ø¹Ø±Ø´ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„
        <i class="fas fa-throne" aria-hidden="true"></i>
      </h1>
      <div class="sub" aria-live="polite">
        <i class="fas fa-users-between-lines" aria-hidden="true"></i> Ø§Ù„Ù…Ù„Ùƒ Ø£Ø¹Ù„Ù‰ Ø±Ù‚Ù… .. Ø§Ù„Ø®Ø§Ø³Ø± Ø£Ù‚Ù„ Ø±Ù‚Ù…
      </div>
    </header>

    <!-- Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ù…Ø¹ Ø¹Ù†Ø§ÙˆÙŠÙ† ARIA -->
    <div class="player-selector" role="tablist" aria-label="Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†">
      <div class="player-option" id="option2" role="tab">
        <button id="select2Players" class="player-btn" aria-label="2 Ù„Ø§Ø¹Ø¨ÙŠÙ†"><i class="fas fa-user-friends"></i> 2</button>
      </div>
      <div class="player-option" id="option3" role="tab">
        <button id="select3Players" class="player-btn" aria-label="3 Ù„Ø§Ø¹Ø¨ÙŠÙ†"><i class="fas fa-users"></i> 3</button>
      </div>
      <div class="player-option" id="option4" role="tab">
        <button id="select4Players" class="player-btn" aria-label="4 Ù„Ø§Ø¹Ø¨ÙŠÙ†"><i class="fas fa-people-arrows"></i> 4</button>
      </div>
    </div>

    <!-- Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† - ØªÙÙ…Ù„Ø£ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
    <div id="playersContainer" class="players-grid" aria-label="Ø³Ø§Ø­Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†"></div>

    <!-- Ø§Ù„Ù…Ø¤Ù‚Øª Ø§Ù„Ø¹Ø§Ù… Ø¨ÙˆØ§Ø¬Ù‡Ø© ÙˆØ§Ø¶Ø­Ø© -->
    <div class="timer-global" aria-label="Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ">
      <div class="timer-box">
        <i class="fas fa-hourglass-half" aria-hidden="true"></i>
        <span id="globalTime" aria-live="assertive">10.0</span>
      </div>
      <div style="font-size:1.2rem;">
        <i class="fas fa-fist-raised" aria-hidden="true"></i> Ø§Ø¶Ø±Ø¨ Ø¨Ø³Ø±Ø¹Ø©
      </div>
    </div>
    <div class="progress" role="progressbar" aria-label="Ø´Ø±ÙŠØ· Ø§Ù„ÙˆÙ‚Øª">
      <div id="progressFill" style="width:100%;"></div>
    </div>

    <!-- ØºØ±ÙØ© Ø§Ù„Ø¹Ø±Ø´: Ø§Ù„Ù…Ù„Ùƒ Ùˆ Ø§Ù„Ø®Ø§Ø³Ø± -->
    <div class="throne-room" aria-label="ØªØ±ØªÙŠØ¨ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†">
      <div class="king-area">
        <i class="fas fa-crown" style="font-size:2rem; color:#ffd700;" aria-hidden="true"></i>
        <span class="king-label" id="kingName">Ù„Ø§ Ù…Ù„Ùƒ</span>
      </div>
      <div class="loser-area">
        <i class="fas fa-broken" style="font-size:1.8rem; color:#a0a0a0;" aria-hidden="true"></i>
        <span class="loser-label" id="loserName">Ù„Ø§ Ø®Ø§Ø³Ø±</span>
      </div>
    </div>

    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…: Ø¥Ø¹Ø§Ø¯Ø© ÙˆØªØ­Ø¯ÙŠ -->
    <div class="control-panel">
      <button id="resetGameBtn" class="ctrl-btn" aria-label="Ø¨Ø¯Ø¡ Ù…Ø¹Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©"><i class="fas fa-rotate-right"></i> Ù…Ø¹Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©</button>
      <button id="hardGlobalBtn" class="ctrl-btn" aria-label="ÙˆØ¶Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠ ÙŠØ®ØµÙ… ÙˆÙ‚Øª Ù…Ø¹ ÙƒÙ„ Ù†Ù‚Ø±Ø©"><i class="fas fa-skull"></i> ØªØ­Ø¯Ù</button>
    </div>

    <footer>
      <p aria-label="Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù„Ø¹Ø¨Ø©">ğŸ‘‘ Ø§Ø¶ØºØ· Ù„ØªØ¹ØªÙ„ÙŠ Ø§Ù„Ø¹Ø±Ø´ .. Ø§Ø­Ø°Ø± Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„Ø®Ø§Ø³Ø±</p>
    </footer>
  </main>

  <script>
    (function() {
      "use strict";

      // ---------------------------------------------------------
      // Ø§Ù„Ø£Ø¨Ø·Ø§Ù„: Ù†Ø³Ø®Ø© Ù†Ù‡Ø§Ø¦ÙŠØ© Ù…ØªÙƒÙŠÙØ© Ù…Ø¹ Ø§Ù„Ù‡Ø§ØªÙ + SEO + Ø£Ø¯Ø§Ø¡ Ø¹Ø§Ù„ÙŠ
      // ---------------------------------------------------------

      // Ø£Ù„ÙˆØ§Ù† ÙˆØ£ÙŠÙ‚ÙˆÙ†Ø§Øª Ù…Ø¨Ù‡Ø±Ø©
      const PLAYER_COLORS = [
        { name: 'Ø§Ù„Ø£Ø­Ù…Ø±', bg: '#b71c1c', light: '#f05545', btn: '#d32f2f', icon: 'fa-dragon' },
        { name: 'Ø§Ù„Ø£Ø²Ø±Ù‚', bg: '#0d47a1', light: '#5472d3', btn: '#1565c0', icon: 'fa-whale' },
        { name: 'Ø§Ù„Ø£Ø®Ø¶Ø±', bg: '#1b5e20', light: '#6ab04a', btn: '#2e7d32', icon: 'fa-tree' },
        { name: 'Ø§Ù„Ø°Ù‡Ø¨ÙŠ', bg: '#7d4e1a', light: '#ffb74d', btn: '#a5641e', icon: 'fa-lion' }
      ];

      // Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
      let playersCount = 2;
      let players = [];
      let timeLeft = 10.0;
      let gameActive = false;
      let gameFinished = false;
      let globalTimer = null;
      let hardMode = false;

      // Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
      const playersContainer = document.getElementById('playersContainer');
      const globalTimeEl = document.getElementById('globalTime');
      const progressFill = document.getElementById('progressFill');
      const kingNameEl = document.getElementById('kingName');
      const loserNameEl = document.getElementById('loserName');
      const resetBtn = document.getElementById('resetGameBtn');
      const hardGlobalBtn = document.getElementById('hardGlobalBtn');
      const select2Btn = document.getElementById('select2Players');
      const select3Btn = document.getElementById('select3Players');
      const select4Btn = document.getElementById('select4Players');
      const option2 = document.getElementById('option2');
      const option3 = document.getElementById('option3');
      const option4 = document.getElementById('option4');

      // ========== Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ==========
      function initPlayers(count) {
        players = [];
        for (let i = 0; i < count; i++) {
          let colorIndex = i % PLAYER_COLORS.length;
          players.push({
            id: i,
            name: `Ø§Ù„Ù„Ø§Ø¹Ø¨ ${i+1}`,
            color: PLAYER_COLORS[colorIndex].bg,
            lightColor: PLAYER_COLORS[colorIndex].light,
            btnColor: PLAYER_COLORS[colorIndex].btn,
            icon: PLAYER_COLORS[colorIndex].icon,
            score: 0,
            isKing: false,
            isLoser: false,
          });
        }
        renderPlayers();
        updateKingAndLoser();
      }

      // ========== Ø±Ø³Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª (Ù…Ø·ÙŠØ¹Ø© Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©) ==========
      function renderPlayers() {
        let html = '';
        players.forEach((p, idx) => {
          html += `
            <div id="playerCard-${idx}" class="player-card" style="border-color: ${p.color}; background: linear-gradient(145deg, #1a1220, #0e0912);">
              <div id="crownIcon-${idx}" class="crown-icon" style="display: none;"><i class="fas fa-crown" style="color: gold; filter: drop-shadow(0 0 12px orange);"></i></div>
              <div id="loserIcon-${idx}" class="loser-icon" style="display: none;"><i class="fas fa-poop" style="color: #6b5a4b; filter: drop-shadow(0 0 6px #3a2a1a);"></i></div>
              <div class="player-name" style="color: ${p.lightColor};">
                <i class="fas ${p.icon}"></i> ${p.name}
              </div>
              <div id="playerScore-${idx}" class="player-score" style="color: white; background: ${p.color}dd; border: 3px solid ${p.lightColor};">
                ${p.score}
              </div>
              <button id="clickBtn-${idx}" class="click-btn" style="background: ${p.btnColor}; color: white; border-color: ${p.lightColor};">
                <i class="fas ${p.icon}"></i> Ø§Ø¶Ø±Ø¨
              </button>
            </div>
          `;
        });
        playersContainer.innerHTML = html;

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù…Ø¹ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¹Ø§Ù„ÙŠ
        players.forEach((_, idx) => {
          const btn = document.getElementById(`clickBtn-${idx}`);
          if (btn) {
            btn.replaceWith(btn.cloneNode(true));
            const newBtn = document.getElementById(`clickBtn-${idx}`);
            newBtn.addEventListener('click', (e) => {
              e.preventDefault();
              e.stopPropagation();
              handlePlayerClick(idx);
            });
            // Ø¯Ø¹Ù… Ø§Ù„Ù„Ù…Ø³ Ù„Ù„Ù‡ÙˆØ§ØªÙ
            newBtn.addEventListener('touchstart', (e) => { e.preventDefault(); }, { passive: false });
          }
        });
      }

      // ========== Ù…Ù†Ø·Ù‚ Ø§Ù„Ù†Ù‚Ø± ==========
      function handlePlayerClick(playerIndex) {
        if (timeLeft <= 0.0) return;
        if (!gameActive && !gameFinished) {
          startGlobalTimer();
          gameActive = true;
        }

        const player = players[playerIndex];
        player.score += 1;
        const scoreEl = document.getElementById(`playerScore-${playerIndex}`);
        if (scoreEl) scoreEl.textContent = player.score;

        // ÙˆØ¶Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠ: Ø®ØµÙ… Ø§Ù„ÙˆÙ‚Øª
        if (hardMode && timeLeft > 0.05) {
          timeLeft = Math.max(0.0, timeLeft - 0.05);
          globalTimeEl.textContent = timeLeft.toFixed(1);
          updateProgressBar();
        }

        // Ø±Ø¯ ÙØ¹Ù„ Ù„Ù…Ø³ÙŠ
        if (navigator.vibrate) navigator.vibrate(8);

        updateKingAndLoser();

        if (timeLeft <= 0.0) {
          timeLeft = 0.0;
          globalTimeEl.textContent = '0.0';
          endGame();
        }
      }

      // ========== ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ùƒ ÙˆØ§Ù„Ø®Ø§Ø³Ø± ==========
      function updateKingAndLoser() {
        if (!players.length) return;
        
        players.forEach(p => { p.isKing = false; p.isLoser = false; });

        let maxScore = -Infinity, minScore = Infinity;
        let kingIdx = 0, loserIdx = 0;

        players.forEach((p, idx) => {
          if (p.score > maxScore) { maxScore = p.score; kingIdx = idx; }
          if (p.score < minScore) { minScore = p.score; loserIdx = idx; }
        });

        if (maxScore === 0 && minScore === 0) {
          kingNameEl.textContent = 'Ù„Ø§ Ù…Ù„Ùƒ';
          loserNameEl.textContent = 'Ù„Ø§ Ø®Ø§Ø³Ø±';
        } else {
          players[kingIdx].isKing = true;
          kingNameEl.textContent = `${players[kingIdx].name} (${players[kingIdx].score})`;
          kingNameEl.style.background = players[kingIdx].color;
          kingNameEl.style.boxShadow = `0 0 35px ${players[kingIdx].lightColor}`;

          players[loserIdx].isLoser = true;
          loserNameEl.textContent = `${players[loserIdx].name} (${players[loserIdx].score})`;
          loserNameEl.style.background = '#2a2a3a';
          loserNameEl.style.boxShadow = `0 0 18px #1e1e1e`;
        }

        // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙŠØ¬Ø§Ù† ÙˆØ£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„Ø®Ø§Ø³Ø±
        players.forEach((p, idx) => {
          const crownIcon = document.getElementById(`crownIcon-${idx}`);
          const loserIcon = document.getElementById(`loserIcon-${idx}`);
          if (crownIcon) crownIcon.style.display = p.isKing ? 'block' : 'none';
          if (loserIcon) loserIcon.style.display = p.isLoser ? 'block' : 'none';

          const card = document.getElementById(`playerCard-${idx}`);
          if (card) {
            if (p.isKing) {
              card.style.border = `5px solid gold`;
              card.style.boxShadow = `0 0 40px gold`;
            } else if (p.isLoser) {
              card.style.border = `3px solid #5a5a5a`;
              card.style.boxShadow = `0 0 15px #3a3a3a`;
            } else {
              card.style.border = `3px solid ${p.color}`;
              card.style.boxShadow = `0 12px 20px #00000080`;
            }
          }
        });
      }

      // ========== Ø§Ù„Ù…Ø¤Ù‚Øª ==========
      function startGlobalTimer() {
        if (globalTimer) clearInterval(globalTimer);
        globalTimer = setInterval(() => {
          if (timeLeft > 0.0) {
            timeLeft = Math.max(0.0, timeLeft - 0.1);
            globalTimeEl.textContent = timeLeft.toFixed(1);
            updateProgressBar();
            if (timeLeft <= 0.0) {
              timeLeft = 0.0;
              globalTimeEl.textContent = '0.0';
              endGame();
              clearInterval(globalTimer);
              globalTimer = null;
            }
          } else {
            endGame();
            clearInterval(globalTimer);
            globalTimer = null;
          }
        }, 100);
      }

      function updateProgressBar() {
        let percent = (timeLeft / 10) * 100;
        if (percent < 0) percent = 0;
        progressFill.style.width = `${percent}%`;
      }

      function endGame() {
        gameActive = false;
        gameFinished = true;
        players.forEach((_, idx) => {
          const btn = document.getElementById(`clickBtn-${idx}`);
          if (btn) btn.disabled = true;
        });
        updateKingAndLoser();
      }

      // ========== Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø· ==========
      function fullReset() {
        if (globalTimer) clearInterval(globalTimer);
        globalTimer = null;
        gameActive = false;
        gameFinished = false;
        timeLeft = 10.0;
        globalTimeEl.textContent = '10.0';
        updateProgressBar();

        players.forEach((p, idx) => {
          p.score = 0;
          p.isKing = false;
          p.isLoser = false;
          const scoreEl = document.getElementById(`playerScore-${idx}`);
          if (scoreEl) scoreEl.textContent = '0';
          const btn = document.getElementById(`clickBtn-${idx}`);
          if (btn) btn.disabled = false;
        });

        kingNameEl.textContent = 'Ù„Ø§ Ù…Ù„Ùƒ';
        loserNameEl.textContent = 'Ù„Ø§ Ø®Ø§Ø³Ø±';
        kingNameEl.style.background = '#ffd700';
        loserNameEl.style.background = '#2a2a3a';

        players.forEach((_, idx) => {
          const crownIcon = document.getElementById(`crownIcon-${idx}`);
          const loserIcon = document.getElementById(`loserIcon-${idx}`);
          if (crownIcon) crownIcon.style.display = 'none';
          if (loserIcon) loserIcon.style.display = 'none';
          const card = document.getElementById(`playerCard-${idx}`);
          if (card && players[idx]) {
            card.style.border = `3px solid ${players[idx].color}`;
            card.style.boxShadow = `0 12px 20px #00000080`;
          }
        });
      }

      // ========== ØªØºÙŠÙŠØ± Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ==========
      function setPlayersCount(count) {
        playersCount = count;
        [option2, option3, option4].forEach(el => el?.classList.remove('active'));
        [select2Btn, select3Btn, select4Btn].forEach(el => el?.classList.remove('active'));

        if (count === 2) { option2?.classList.add('active'); select2Btn?.classList.add('active'); }
        else if (count === 3) { option3?.classList.add('active'); select3Btn?.classList.add('active'); }
        else { option4?.classList.add('active'); select4Btn?.classList.add('active'); }

        fullReset();
        initPlayers(count);
      }

      // ========== ÙˆØ¶Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠ ==========
      function toggleHardMode() {
        hardMode = !hardMode;
        if (hardMode) {
          hardGlobalBtn.style.background = '#7a2e2e';
          hardGlobalBtn.style.borderColor = '#ff8a5c';
          hardGlobalBtn.innerHTML = '<i class="fas fa-skull"></i> ØªØ­Ø¯Ù Ù†Ø´Ø·';
        } else {
          hardGlobalBtn.style.background = '#2a1e32';
          hardGlobalBtn.style.borderColor = '#b4945c';
          hardGlobalBtn.innerHTML = '<i class="fas fa-skull"></i> ØªØ­Ø¯Ù';
        }
      }

      // ========== Ø±Ø¨Ø· Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ==========
      select2Btn.addEventListener('click', () => setPlayersCount(2));
      select3Btn.addEventListener('click', () => setPlayersCount(3));
      select4Btn.addEventListener('click', () => setPlayersCount(4));
      resetBtn.addEventListener('click', () => { fullReset(); initPlayers(playersCount); });
      hardGlobalBtn.addEventListener('click', toggleHardMode);

      // Ø¨Ø¯Ø§ÙŠØ© Ù…Ø«Ø§Ù„ÙŠØ© Ù…Ø¹ Ù„Ø§Ø¹Ø¨ÙŠÙ†
      setPlayersCount(2);
    })();
  </script>
</body>
</html>
