<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø£Ø¨Ø·Ø§Ù„ âš”ï¸ - Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</title>
  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      user-select: none;
      font-family: 'Cairo', sans-serif;
    }
    body {
      background: radial-gradient(circle at 20% 30%, #0a0f1f, #03050a);
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 16px;
    }
    .game {
      background: rgba(8, 18, 28, 0.85);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border: 2px solid rgba(255, 215, 0, 0.25);
      border-radius: 64px;
      padding: 28px 22px;
      max-width: 800px;
      width: 100%;
      box-shadow: 0 30px 50px #00000080, 0 0 0 1px #ffd96633 inset;
      text-align: center;
    }

    h1 {
      font-size: 2.2rem;
      font-weight: 900;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      text-shadow: 0 0 18px #f9d71c;
    }
    h1 i {
      color: #ffd966;
      filter: drop-shadow(0 0 10px gold);
    }

    .sub {
      background: #00000040;
      padding: 10px 22px;
      border-radius: 60px;
      display: inline-block;
      margin: 8px 0 18px;
      border: 1px solid #f6c445;
      font-size: 1.1rem;
    }

    /* Ù„ÙˆØ­Ø© Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† - ØªØµÙ…ÙŠÙ… Ø¬Ø°Ø§Ø¨ */
    .player-selector {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 10px 0 25px;
    }
    .player-option {
      background: #1f3140;
      border-radius: 60px;
      padding: 6px;
      display: flex;
      border: 2px solid transparent;
      transition: 0.2s;
    }
    .player-option.active {
      border: 2px solid #ffd966;
      background: #1f405e;
      box-shadow: 0 0 20px #ffbf00;
    }
    .player-btn {
      background: #2a4055;
      border: none;
      color: white;
      font-size: 1.2rem;
      font-weight: bold;
      padding: 12px 26px;
      border-radius: 50px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: 0.1s;
    }
    .player-btn i {
      font-size: 1.5rem;
    }
    .player-btn.active {
      background: #ffbf00;
      color: #0a0f1a;
      box-shadow: 0 0 25px #ffb300;
    }
    .player-btn.active i {
      color: #0a0f1a;
    }

    /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† - ÙƒÙ„ Ù„Ø§Ø¹Ø¨ Ø¨Ø·Ø§Ù‚Ø© Ù…Ù…ÙŠØ²Ø© Ø¨Ù„ÙˆÙ†Ù‡ */
    .players-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 18px;
      margin: 25px 0 15px;
    }
    .player-card {
      flex: 1 1 180px;
      background: rgba(10, 22, 35, 0.9);
      border-radius: 40px;
      padding: 18px 12px;
      box-shadow: 0 10px 20px #00000060;
      transition: 0.2s;
      border: 2px solid;
      position: relative;
      backdrop-filter: blur(4px);
    }
    .player-name {
      font-size: 1.6rem;
      font-weight: 900;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-bottom: 8px;
    }
    .player-score {
      font-size: 2.1rem;
      font-weight: 900;
      background: #00000055;
      border-radius: 80px;
      padding: 8px 12px;
      width: fit-content;
      margin: 8px auto;
      border: 1px solid #ffffff55;
    }
    .click-btn {
      width: 100%;
      padding: 14px 0;
      border-radius: 60px;
      border: none;
      font-size: 1.3rem;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-top: 8px;
      cursor: pointer;
      transition: 0.07s;
      border: 2px solid white;
    }
    .click-btn:active {
      transform: scale(0.92);
    }
    .click-btn:disabled {
      opacity: 0.5;
      transform: none;
      filter: grayscale(0.6);
    }

    /* Ø§Ù„Ù…Ø¤Ù‚Øª ÙˆØ§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ø§Ù… */
    .global-timer {
      background: #0e1c2ab0;
      border-radius: 60px;
      padding: 14px 18px;
      margin: 8px 0 16px;
      border: 1px solid #ffd966;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .timer-box {
      font-size: 2rem;
      font-weight: 900;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    #globalTime {
      background: #00000070;
      padding: 5px 20px;
      border-radius: 40px;
      color: #ffe082;
    }
    .progress {
      width: 100%;
      height: 14px;
      background: #2f3e55;
      border-radius: 20px;
      margin-top: 8px;
    }
    #progressFill {
      height: 100%;
      width: 100%;
      background: linear-gradient(90deg, #ffb82e, #ffe174);
      border-radius: 20px;
      transition: width 0.15s;
      box-shadow: 0 0 12px #ffbf00;
    }

    /* Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù - Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…ØªÙˆÙ‡Ø¬ */
    .leader-section {
      background: #071018e0;
      border-radius: 60px;
      padding: 14px 20px;
      margin: 18px 0 8px;
      border: 2px solid gold;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .leader-title {
      font-size: 1.4rem;
      font-weight: bold;
    }
    #leaderName {
      background: #ffbf00;
      color: #0a0f1a;
      padding: 8px 28px;
      border-radius: 50px;
      font-weight: 900;
      font-size: 1.6rem;
      box-shadow: 0 0 30px #ffb300;
      transition: 0.2s;
    }

    .control-panel {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin: 18px 0 5px;
    }
    .ctrl-btn {
      background: #1e3347;
      border: 1px solid #ffcd7e;
      color: #ffcd7e;
      padding: 12px 24px;
      border-radius: 50px;
      font-size: 1.1rem;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      transition: 0.1s;
    }
    .ctrl-btn:hover {
      background: #2f516e;
      color: white;
      border-color: #ffb82e;
    }

    .winner-highlight {
      border: 4px solid gold !important;
      box-shadow: 0 0 35px gold;
      transform: scale(1.02);
    }
  </style>
</head>
<body>
  <div class="game">
    <h1>
      <i class="fas fa-shield-haltered"></i> Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø£Ø¨Ø·Ø§Ù„
      <i class="fas fa-crosshairs"></i>
    </h1>
    <div class="sub">
      <i class="fas fa-users"></i> Ø§Ø®ØªØ§Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù‚Ø§ØªÙ„ÙŠÙ† .. ÙˆÙ†Ù‘ÙˆØ± Ø§Ù„Ø£Ù‚ÙˆÙ‰
    </div>

    <!-- Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†: 2 Ø£Ùˆ 3 (ÙˆØ¥Ø¶Ø§ÙØ© 1 Ù„Ù„ØªØ¯Ø±ÙŠØ¨ Ù„ÙƒÙ† Ø³Ù†Ø±ÙƒØ² Ø¹Ù„Ù‰ 2 Ùˆ3) -->
    <div class="player-selector">
      <div class="player-option" id="option2">
        <button id="select2Players" class="player-btn"><i class="fas fa-user-friends"></i> 2 Ù„Ø§Ø¹Ø¨ÙŠÙ†</button>
      </div>
      <div class="player-option" id="option3">
        <button id="select3Players" class="player-btn"><i class="fas fa-users"></i> 3 Ù„Ø§Ø¹Ø¨ÙŠÙ†</button>
      </div>
    </div>

    <!-- Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† - ØªÙØ­Ù‚Ù† Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ø¨Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„Ø®ØµØ§Ø¦Øµ -->
    <div id="playersContainer" class="players-grid"></div>

    <!-- Ø§Ù„Ù…Ø¤Ù‚Øª Ø§Ù„Ø¹Ø§Ù… ÙˆØ´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… -->
    <div class="global-timer">
      <div class="timer-box">
        <i class="fas fa-hourglass-half"></i>
        <span id="globalTime">10.0</span>
      </div>
      <div style="font-size:1.3rem;">
        <i class="fas fa-crown"></i> Ù…Ù† ÙŠØ³ÙˆØ¯ØŸ
      </div>
    </div>
    <div class="progress">
      <div id="progressFill" style="width:100%;"></div>
    </div>

    <!-- Ù†Ø§ÙÙˆØ±Ø© Ø§Ù„Ø´Ø±Ù: Ø§Ù„Ù…ØªØµØ¯Ø± ÙŠØªÙˆÙ‡Ø¬ ÙˆÙŠÙØ°ÙƒØ± Ø§Ø³Ù…Ù‡ -->
    <div class="leader-section">
      <span class="leader-title"><i class="fas fa-star"></i> Ø§Ù„Ù…ØªØµØ¯Ø± Ø§Ù„Ù„Ø§Ù…Ø¹</span>
      <span id="leaderName">â€”</span>
    </div>

    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…: Ø¨Ø¯Ø¡ / Ø¥Ø¹Ø§Ø¯Ø© / Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ØµØ¹Ø¨ (ÙŠØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù…ÙŠØ¹) -->
    <div class="control-panel">
      <button id="resetGameBtn" class="ctrl-btn"><i class="fas fa-rotate-right"></i> Ù…Ø¹Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©</button>
      <button id="hardGlobalBtn" class="ctrl-btn"><i class="fas fa-skull"></i> ÙˆØ¶Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠ</button>
    </div>
    <p style="margin-top:12px; opacity:0.8;"><i class="fas fa-bolt"></i> ÙƒÙ„ Ù„Ø§Ø¹Ø¨ Ù„Ù‡ Ù„ÙˆÙ†Ù‡ Ø§Ù„Ø®Ø§Øµ .. Ø§Ù„Ø£ÙƒØ«Ø± Ù†Ù‚Ø§Ø·Ù‹Ø§ ÙŠØ´Ø¹ Ù†ÙˆØ±Ù‹Ø§!</p>
  </div>

  <script>
    (function(){
      "use strict";

      // -------------------------------------------------------------
      // ğŸ† Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠØ© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† (2 Ø£Ùˆ 3) - ÙƒÙ„ Ù„Ø§Ø¹Ø¨ Ù„ÙˆÙ†
      // -------------------------------------------------------------
      
      // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ù„ÙƒÙ„ Ù„Ø§Ø¹Ø¨ (Ù…Ø¨Ù‡Ø¬Ø© ÙˆÙ…ØªØ¨Ø§ÙŠÙ†Ø©)
      const PLAYER_COLORS = [
        { name: 'Ø§Ù„Ø£Ø­Ù…Ø±', bg: '#d32f2f', light: '#ff6659', btn: '#f05545', text: 'white', icon: 'fa-dragon' },
        { name: 'Ø§Ù„Ø£Ø²Ø±Ù‚', bg: '#1565c0', light: '#5e92f3', btn: '#1e88e5', text: 'white', icon: 'fa-whale' },
        { name: 'Ø§Ù„Ø£Ø®Ø¶Ø±', bg: '#2e7d32', light: '#6ab04a', btn: '#43a047', text: 'white', icon: 'fa-tree' }
      ];

      // Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø©
      let playersCount = 2;           // Ø§ÙØªØ±Ø§Ø¶ÙŠ
      let players = [];
      let timeLeft = 10.0;
      let gameActive = false;        // ÙŠØ¨Ø¯Ø£ Ø¨Ø£ÙˆÙ„ Ù†Ù‚Ø±Ø©
      let gameFinished = false;
      let globalTimer = null;
      let hardMode = false;          // ÙˆØ¶Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠ: ÙƒÙ„ Ù†Ù‚Ø±Ø© ØªÙ†Ù‚Øµ 0.05 Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ø¬Ù…ÙŠØ¹
      
      // Ø¹Ù†Ø§ØµØ± DOM
      const playersContainer = document.getElementById('playersContainer');
      const globalTimeEl = document.getElementById('globalTime');
      const progressFill = document.getElementById('progressFill');
      const leaderNameEl = document.getElementById('leaderName');
      const resetBtn = document.getElementById('resetGameBtn');
      const hardGlobalBtn = document.getElementById('hardGlobalBtn');
      const select2Btn = document.getElementById('select2Players');
      const select3Btn = document.getElementById('select3Players');
      const option2 = document.getElementById('option2');
      const option3 = document.getElementById('option3');

      // ========== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø¯Ø¯ ==========
      function initPlayers(count) {
        players = [];
        for (let i = 0; i < count; i++) {
          let colorIndex = i % PLAYER_COLORS.length;
          players.push({
            id: i,
            name: `Ø§Ù„Ù„Ø§Ø¹Ø¨ ${i+1}`,
            color: PLAYER_COLORS[colorIndex].bg,
            lightColor: PLAYER_COLORS[colorIndex].light,
            btnColor: PLAYER_COLORS[colorIndex].btn,
            icon: PLAYER_COLORS[colorIndex].icon,
            score: 0,
            clickCount: 0,
            isWinner: false
          });
        }
        renderPlayers();
        updateLeader(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØµØ¯Ø±
      }

      // ========== Ø±Ø³Ù… Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¯Ø§Ø®Ù„ grid ==========
      function renderPlayers() {
        let html = '';
        players.forEach((p, idx) => {
          html += `
            <div id="playerCard-${idx}" class="player-card" style="border-color: ${p.color}; background: linear-gradient(145deg, #0f1e2c, #0a1722);">
              <div class="player-name" style="color: ${p.lightColor};">
                <i class="fas ${p.icon}"></i> ${p.name}
              </div>
              <div id="playerScore-${idx}" class="player-score" style="color: white; background: ${p.color}cc; border: 2px solid ${p.lightColor};">
                ${p.score}
              </div>
              <button id="clickBtn-${idx}" class="click-btn" style="background: ${p.btnColor}; color: white; border-color: ${p.lightColor};" ${!gameActive && !gameFinished ? '' : ''}>
                <i class="fas ${p.icon}"></i> Ø§Ø¶Ø±Ø¨ ${p.name}
              </button>
            </div>
          `;
        });
        playersContainer.innerHTML = html;

        // Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø®Ø§ØµØ© Ø¨ÙƒÙ„ Ù„Ø§Ø¹Ø¨
        players.forEach((p, idx) => {
          const btn = document.getElementById(`clickBtn-${idx}`);
          if (btn) {
            // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ù…Ø³ØªÙ…Ø¹ Ø³Ø§Ø¨Ù‚ (Ù„ØªØ¬Ù†Ø¨ ØªÙƒØ±Ø§Ø± Ø§Ù„Ø£Ø­Ø¯Ø§Ø«)
            btn.replaceWith(btn.cloneNode(true));
            const newBtn = document.getElementById(`clickBtn-${idx}`);
            newBtn.addEventListener('click', (e) => {
              e.stopPropagation();
              handlePlayerClick(idx);
            });
          }
        });
      }

      // ========== Ù…Ø¹Ø§Ù„Ø¬Ø© Ù†Ù‚Ø±Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ ==========
      function handlePlayerClick(playerIndex) {
        const player = players[playerIndex];
        if (!player) return;
        
        // Ø¥Ø°Ø§ Ø§Ù„Ù„Ø¹Ø¨Ø© Ù…Ù†ØªÙ‡ÙŠØ© Ø£Ùˆ Ø§Ù„ÙˆÙ‚Øª ØµÙØ± â†’ Ù…Ù…Ù†ÙˆØ¹
        if (timeLeft <= 0.0) return;
        
        // Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ø¹ Ø£ÙˆÙ„ Ù†Ù‚Ø±Ø©
        if (!gameActive && !gameFinished) {
          startGlobalTimer();
          gameActive = true;
          gameFinished = false;
        }
        
        // Ø²ÙŠØ§Ø¯Ø© Ù†Ù‚Ø§Ø· Ø§Ù„Ù„Ø§Ø¹Ø¨ (Ù†Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø© Ø£Ø³Ø§Ø³ÙŠØ©)
        player.score += 1;
        
        // ÙÙŠ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ØµØ¹Ø¨: Ø®ØµÙ… ÙˆÙ‚Øª Ø¹Ø§Ù„Ù…ÙŠ 0.05 Ø«Ø§Ù†ÙŠØ© Ù„ÙƒÙ„ Ù†Ù‚Ø±Ø©
        if (hardMode && timeLeft > 0.1) {
          timeLeft = Math.max(0.0, timeLeft - 0.05);
          globalTimeEl.textContent = timeLeft.toFixed(1);
          updateProgressBar();
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ù†Ù‚Ø§Ø· Ù‡Ø°Ø§ Ø§Ù„Ù„Ø§Ø¹Ø¨
        const scoreEl = document.getElementById(`playerScore-${playerIndex}`);
        if (scoreEl) {
          scoreEl.textContent = player.score;
        }
        
        // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø§Ù‡ØªØ²Ø§Ø²
        if (navigator.vibrate) navigator.vibrate(12);
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØµØ¯Ø± (Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù„ÙŠ Ø¹Ù†Ø¯Ù‡ Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø·)
        updateLeader();
        
        // ÙØ­Øµ Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª ØªÙˆØ§Ù‹
        if (timeLeft <= 0.0) {
          timeLeft = 0.0;
          globalTimeEl.textContent = '0.0';
          endGame();
        }
      }

      // ========== Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª Ø§Ù„Ø¹Ø§Ù… ==========
      function startGlobalTimer() {
        if (globalTimer) clearInterval(globalTimer);
        globalTimer = setInterval(() => {
          if (timeLeft > 0.0) {
            timeLeft = Math.max(0.0, timeLeft - 0.1);
            globalTimeEl.textContent = timeLeft.toFixed(1);
            updateProgressBar();
            
            if (timeLeft <= 0.0) {
              timeLeft = 0.0;
              globalTimeEl.textContent = '0.0';
              endGame();
              clearInterval(globalTimer);
              globalTimer = null;
            }
          } else {
            endGame();
            clearInterval(globalTimer);
            globalTimer = null;
          }
        }, 100);
      }

      // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
      function updateProgressBar() {
        let percent = (timeLeft / 10) * 100;
        if (percent < 0) percent = 0;
        progressFill.style.width = `${percent}%`;
      }

      // ========== Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø©: Ù…Ù†Ø¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ¥Ø´Ù‡Ø§Ø± Ø§Ù„ÙØ§Ø¦Ø² ==========
      function endGame() {
        gameActive = false;
        gameFinished = true;
        // ØªØ¹Ø·ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
        players.forEach((_, idx) => {
          const btn = document.getElementById(`clickBtn-${idx}`);
          if (btn) btn.disabled = true;
        });
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ØªØµØ¯Ø± Ø¨Ø´ÙƒÙ„ Ù†Ù‡Ø§Ø¦ÙŠ
        updateLeader(true);
        // Ø­ÙØ¸ Ø£ÙØ¶Ù„ Ù†ØªÙŠØ¬Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) - ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØªÙ‡Ø§
      }

      // ========== ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…ØªØµØ¯Ø± (Ø§Ù„Ù„ÙŠ Ù†ÙˆØ±Ù‡ Ø¹Ø§Ù„ÙŠ) ==========
      function updateLeader(isFinal = false) {
        if (players.length === 0) return;
        
        // Ø¥ÙŠØ¬Ø§Ø¯ Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø·
        let maxScore = -1;
        let leaderIndex = 0;
        players.forEach((p, idx) => {
          if (p.score > maxScore) {
            maxScore = p.score;
            leaderIndex = idx;
          }
        });
        
        const leaderPlayer = players[leaderIndex];
        // Ø¹Ø±Ø¶ Ø§Ø³Ù… Ø§Ù„Ù…ØªØµØ¯Ø±
        if (leaderPlayer.score > 0 || isFinal) {
          leaderNameEl.textContent = `${leaderPlayer.name} (${leaderPlayer.score})`;
          leaderNameEl.style.background = leaderPlayer.color;
          leaderNameEl.style.boxShadow = `0 0 40px ${leaderPlayer.color}`;
        } else {
          leaderNameEl.textContent = 'â€”';
        }
        
        // Ø¥Ø²Ø§Ù„Ø© ÙƒÙ„ Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
        players.forEach((_, idx) => {
          const card = document.getElementById(`playerCard-${idx}`);
          if (card) {
            card.classList.remove('winner-highlight');
          }
        });
        
        // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†ÙˆØ± Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ù…ØªØµØ¯Ø±
        const leaderCard = document.getElementById(`playerCard-${leaderIndex}`);
        if (leaderCard && leaderPlayer.score > 0) {
          leaderCard.classList.add('winner-highlight');
          // ØªØ®ØµÙŠØµ Ù„ÙˆÙ† Ø§Ù„Ø­Ø¯ÙˆØ¯
          leaderCard.style.borderColor = leaderPlayer.lightColor;
        }
      }

      // ========== Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ù„Ø¹Ø¨Ø© ÙƒÙ„ÙŠØ§Ù‹ ==========
      function fullReset() {
        // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¤Ù‚Øª
        if (globalTimer) {
          clearInterval(globalTimer);
          globalTimer = null;
        }
        gameActive = false;
        gameFinished = false;
        timeLeft = 10.0;
        globalTimeEl.textContent = '10.0';
        updateProgressBar();
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù†Ù‚Ø§Ø· Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
        players.forEach((p, idx) => {
          p.score = 0;
          p.clickCount = 0;
          // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
          const scoreEl = document.getElementById(`playerScore-${idx}`);
          if (scoreEl) scoreEl.textContent = '0';
          
          const btn = document.getElementById(`clickBtn-${idx}`);
          if (btn) btn.disabled = false;
        });
        
        leaderNameEl.textContent = 'â€”';
        leaderNameEl.style.background = '#ffbf00'; // default
        leaderNameEl.style.boxShadow = '0 0 30px #ffb300';
        
        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù‡Ø§ÙŠÙ„Ø§ÙŠØª Ù…Ù† Ø§Ù„Ø¬Ù…ÙŠØ¹
        players.forEach((_, idx) => {
          const card = document.getElementById(`playerCard-${idx}`);
          if (card) card.classList.remove('winner-highlight');
        });
      }

      // ========== ØªØºÙŠÙŠØ± Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ==========
      function setPlayersCount(count) {
        playersCount = count;
        // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±
        if (count === 2) {
          option2.classList.add('active');
          select2Btn.classList.add('active');
          option3.classList.remove('active');
          select3Btn.classList.remove('active');
        } else {
          option3.classList.add('active');
          select3Btn.classList.add('active');
          option2.classList.remove('active');
          select2Btn.classList.remove('active');
        }
        
        fullReset(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù…Ø¹ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯
        initPlayers(count);
      }

      // ========== ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ØµØ¹Ø¨ ==========
      function toggleHardMode() {
        hardMode = !hardMode;
        if (hardMode) {
          hardGlobalBtn.style.background = '#9c2c2c';
          hardGlobalBtn.style.borderColor = '#ff8a5c';
          hardGlobalBtn.innerHTML = '<i class="fas fa-skull"></i> ØªØ­Ø¯ÙŠ Ù†Ø´Ø·';
        } else {
          hardGlobalBtn.style.background = '#1e3347';
          hardGlobalBtn.style.borderColor = '#ffcd7e';
          hardGlobalBtn.innerHTML = '<i class="fas fa-skull"></i> ÙˆØ¶Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠ';
        }
      }

      // ========== Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¹Ø§Ù…Ø© ==========
      
      // Ø§Ø®ØªÙŠØ§Ø± Ù„Ø§Ø¹Ø¨ÙŠÙ†
      select2Btn.addEventListener('click', () => setPlayersCount(2));
      select3Btn.addEventListener('click', () => setPlayersCount(3));
      
      // Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© (Ù…Ø¹Ø±ÙƒØ© Ø¬Ø¯ÙŠØ¯Ø©)
      resetBtn.addEventListener('click', () => {
        fullReset();
        // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ù†ÙØ³ Ø§Ù„Ø¹Ø¯Ø¯ Ù…Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
        initPlayers(playersCount);
      });
      
      // Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ØµØ¹Ø¨
      hardGlobalBtn.addEventListener('click', toggleHardMode);

      // ========== Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„ ==========
      // ØªÙ‡ÙŠØ¦Ø© Ø£ÙˆÙ„ÙŠØ©: 2 Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹
      setPlayersCount(2);
      
      // Ù…Ù„Ø§Ø­Ø¸Ø©: Ù…Ù†Ø¹ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª ÙÙŠ Ø§Ù„Ù€ handle Ù†ÙØ³Ù‡
      // ÙƒÙ…Ø§ ØªÙ… ØªØ¶Ù…ÙŠÙ†Ù‡
      
      // Ø¯Ø¹Ù… Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù„Ù…Ø³
      window.addEventListener('touchstart', () => {});
      
      // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ø¨Ø´ÙƒÙ„ Ù…ØªÙ‚Ù†
      // Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ù†Ù‚Ø± Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
    })();
  </script>
</body>
</html>
